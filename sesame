-- vim: ft=lua:
-- True is locking the location
redstone.setOutput("left",true)
local sensor,authfile,signal
local authorisedUsers = {}
for key, name in pairs(peripheral.getNames()) do
    if (peripheral.getType(name) == "openperipheral_sensor") then 
        sensor = peripheral.wrap(name)
    end
end
assert(sensor)

authfile = assert(fs.open("auth","r"))
while (table.insert(authorisedUsers, authfile.readLine())) do end
authfile.close()

while true do
    signal = true
    for key, name in pairs(sensor.getPlayerNames()) do
        for i=0,#authorisedUsers do
            if name == authorisedUsers[i] then
                signal = false
            end

        end
    end

    redstone.setOutput("left",signal)
    os.sleep(0.5)
end
